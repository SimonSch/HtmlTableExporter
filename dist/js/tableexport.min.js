/*!
 * TableExport.js v3.2.5 (http://www.clarketravis.com)
 * Copyright 2016 Travis Clarke
 * Licensed under the MIT license
 *
 */
!function(t,e){function n(t,e){e&&(t+=1462);var n=Date.parse(t);return(n-new Date(Date.UTC(1899,11,30)))/864e5}function o(t,e){for(var o={},a={s:{c:1e7,r:1e7},e:{c:0,r:0}},r=0;r!=t.length;++r)for(var i=0;i!=t[r].length;++i){a.s.r>r&&(a.s.r=r),a.s.c>i&&(a.s.c=i),a.e.r<r&&(a.e.r=r),a.e.c<i&&(a.e.c=i);var f={v:t[r][i]};if(null!=f.v){var l=XLSX.utils.encode_cell({c:i,r:r});"number"==typeof f.v?f.t="n":"boolean"==typeof f.v?f.t="b":f.v instanceof Date?(f.t="n",f.z=XLSX.SSF._table[14],f.v=n(f.v)):f.t="s",o[l]=f}}return a.s.c<1e7&&(o["!ref"]=XLSX.utils.encode_range(a)),o}function a(){return this instanceof a?(this.SheetNames=[],void(this.Sheets={})):new a}function r(t){for(var e=new ArrayBuffer(t.length),n=new Uint8Array(e),o=0;o!=t.length;++o)n[o]=255&t.charCodeAt(o);return e}function i(t,e,n,i){if(".xlsx"===i){var l=new a,s=o(t);l.SheetNames.push(n),l.Sheets[n]=s;var x={bookType:"xlsx",bookSST:!1,type:"binary"},p=XLSX.write(l,x);t=r(p)}saveAs(new Blob([t],{type:e+";"+f.fn.tableExport.charset}),n+i)}var f=t.jQuery;f.fn.tableExport=function(t,e){var n,o,a,r=this,l=e?t:f.extend({},f.fn.tableExport.defaults,t),s=f.fn.tableExport.rowDel,x=l.ignoreRows instanceof Array?l.ignoreRows:[l.ignoreRows],p=l.ignoreCols instanceof Array?l.ignoreCols:[l.ignoreCols],u=l.ignoreCSS instanceof Array?l.ignoreCSS.join(", "):l.ignoreCSS;return l.bootstrap?(n=f.fn.tableExport.bootstrap[0]+" ",o=f.fn.tableExport.bootstrap[1]+" ",a=f.fn.tableExport.bootstrap[2]+" "):(n=f.fn.tableExport.defaultButton+" ",o=a=""),r.each(function(){function t(t){var e=t,n=e.data,o=e.fileName,a=e.mimeType,r=e.fileExtension;i(n,a,o,r)}var n=f(this);e&&n.find("caption:not(.head)").remove();var o=n.find("tbody").find("tr"),o=l.headings?o.add(n.find("thead>tr")):o,o=l.footers?o.add(n.find("tfoot>tr")):o,a=l.headings?n.find("thead>tr").length:0,r="id"===l.fileName?n.attr("id")?n.attr("id"):f.fn.tableExport.defaultFileName:l.fileName,b={xlsx:function(e,n){var r=o.map(function(t,e){if(!~x.indexOf(t-a)&&!f(e).is(u)){var n=f(e).find("th, td");return[n.map(function(t,e){if(!~p.indexOf(t)&&!f(e).is(u))return f(e).text()}).get()]}}).get(),i=JSON.stringify({data:r,fileName:n,mimeType:f.fn.tableExport.xlsx.mimeType,fileExtension:f.fn.tableExport.xlsx.fileExtension});f.fn.tableExport.xlsx.buttonContent,f.fn.tableExport.xlsx.defaultClass;t(i)},xls:function(e,n){var r=f.fn.tableExport.xls.separator,i=o.map(function(t,e){if(!~x.indexOf(t-a)&&!f(e).is(u)){var n=f(e).find("th, td");return n.map(function(t,e){if(!~p.indexOf(t)&&!f(e).is(u))return f(e).text()}).get().join(r)}}).get().join(e),l=JSON.stringify({data:i,fileName:n,mimeType:f.fn.tableExport.xls.mimeType,fileExtension:f.fn.tableExport.xls.fileExtension});f.fn.tableExport.xls.buttonContent,f.fn.tableExport.xls.defaultClass;t(l)},csv:function(e,n){var r=f.fn.tableExport.csv.separator,i=o.map(function(t,e){if(!~x.indexOf(t-a)&&!f(e).is(u)){var n=f(e).find("th, td");return n.map(function(t,e){if(!~p.indexOf(t)&&!f(e).is(u))return f(e).text()}).get().join(r)}}).get().join(e),l=JSON.stringify({data:i,fileName:n,mimeType:f.fn.tableExport.csv.mimeType,fileExtension:f.fn.tableExport.csv.fileExtension});f.fn.tableExport.csv.buttonContent,f.fn.tableExport.csv.defaultClass;t(l)},txt:function(e,n){var r=f.fn.tableExport.txt.separator,i=o.map(function(t,e){if(!~x.indexOf(t-a)&&!f(e).is(u)){var n=f(e).find("th, td");return n.map(function(t,e){if(!~p.indexOf(t)&&!f(e).is(u))return f(e).text()}).get().join(r)}}).get().join(e),l=JSON.stringify({data:i,fileName:n,mimeType:f.fn.tableExport.txt.mimeType,fileExtension:f.fn.tableExport.txt.fileExtension});f.fn.tableExport.txt.buttonContent,f.fn.tableExport.txt.defaultClass;t(l)}};l.formats.forEach(function(t){b[t](s,r)})}),f.fn.tableExport.update=function(t){r.tableExport(f.extend({},l,t),!0)},f.fn.tableExport.reset=function(t){r.tableExport(l,!0)},f.fn.tableExport.remove=function(t){r.each(function(){f(this).find("caption:not(.head)").remove()})},r},f.fn.tableExport.defaults={headings:!0,footers:!0,formats:["xls","csv","txt"],fileName:"id",bootstrap:!0,position:"bottom",ignoreRows:null,ignoreCols:null,ignoreCSS:".tableexport-ignore"},f.fn.tableExport.charset="charset=utf-8",f.fn.tableExport.xlsx={defaultClass:"xlsx",buttonContent:"Export to xlsx",mimeType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",fileExtension:".xlsx"},f.fn.tableExport.xls={defaultClass:"xls",buttonContent:"Export to xls",separator:"\t",mimeType:"application/vnd.ms-excel",fileExtension:".xls"},f.fn.tableExport.csv={defaultClass:"csv",buttonContent:"Export to csv",separator:",",mimeType:"application/csv",fileExtension:".csv"},f.fn.tableExport.txt={defaultClass:"txt",buttonContent:"Export to txt",separator:"  ",mimeType:"text/plain",fileExtension:".txt"},f.fn.tableExport.defaultFileName="myDownload",f.fn.tableExport.defaultButton="button-default",f.fn.tableExport.bootstrap=["btn","btn-default","btn-toolbar"],f.fn.tableExport.rowDel="\r\n",f.fn.tableExport.entityMap={"&":"&#38;","<":"&#60;",">":"&#62;","'":"&#39;","/":"&#47"}}(window);