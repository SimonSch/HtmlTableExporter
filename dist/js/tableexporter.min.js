/*!
 * TableExporter.js v0.0.1
 * Copyright 2016 Travis Clarke
 * Licensed under the MIT license
 *
 * Edited by SimonSch
 */
!function(t,e){function n(t,e){return r.each(e,function(e,o){r.isPlainObject(o)?"object"===o.type?t=n(t,o.options):t+="<th>"+(o.columnName?o.columnName:o.fieldName)+"</th>":t+="<th>"+o+"</th>"}),t}function o(t,n,a){for(var r=0;r<a.length;++r){var i=a[r];if(n)if(i.type&&"object"===i.type)t=o(t,n[i.fieldName],i.options);else if(i.type&&"date"===i.type)if(n[i.fieldName]){var l=n[i.fieldName];t+=l!==e&&null!==l?"<td>"+new Date(l).toLocaleString("de")+"</td>":"<td></td>"}else t+="<td></td>";else{var f=i.fieldName?i.fieldName:i;if(n[f]){var l=n[f];t+=l!==e&&null!==l?"<td>"+l+"</td>":"<td></td>"}else t+="<td></td>"}else t+="<td></td>"}return t}function a(t,e,a){return a.length>0&&(t+="<tr>",t=n(t,a),t+="</tr>",r.each(e,function(e,n){t+="<tr>",t=o(t,n,a),t+="</tr>"})),t}var r=t.jQuery;r.fn.convertJsonToHtml=function(t,e){var n=r.parseJSON(t),o='<table border="1">';return e?(o=a(o,n,e),o+="</table>"):(r.each(n,function(t,e){o+="<tr>",r.each(e,function(t,e){o+="<td>"+t+"</td>",o+="<td>"+e+"</td>"}),o+="</tr>"}),o+="</table>")},r.fn.tableExport=function(t,e){var n=this,o=e?t:r.extend({},r.fn.tableExport.defaults,t);r.fn.tableExport.rowDel,o.ignoreRows instanceof Array?o.ignoreRows:[o.ignoreRows],o.ignoreCols instanceof Array?o.ignoreCols:[o.ignoreCols],o.ignoreCSS instanceof Array?o.ignoreCSS.join(", "):o.ignoreCSS;return n.each(function(){var t=r(this);e&&t.find("caption:not(.head)").remove();var n=t.find("tbody").find("tr"),n=o.headings?n.add(t.find("thead>tr")):n,n=o.footers?n.add(t.find("tfoot>tr")):n;o.headings?t.find("thead>tr").length:0,"id"===o.fileName?t.attr("id")?t.attr("id"):r.fn.tableExport.defaultFileName:o.fileName}),r.fn.tableExport.update=function(t){n.tableExport(r.extend({},o,t),!0)},r.fn.tableExport.reset=function(t){n.tableExport(o,!0)},r.fn.tableExport.remove=function(t){n.each(function(){r(this).find("caption:not(.head)").remove()})},n},r.fn.tableExport.defaults={headings:!0,footers:!0,format:"csv",fileName:"id",ignoreRows:null,ignoreCols:null,ignoreCSS:".tableexport-ignore"},r.fn.tableExport.charset="charset=utf-8",r.fn.tableExport.xlsx={defaultClass:"xlsx",buttonContent:"Export to xlsx",mimeType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",fileExtension:".xlsx"},r.fn.tableExport.xls={defaultClass:"xls",buttonContent:"Export to xls",separator:"\t",mimeType:"application/vnd.ms-excel",fileExtension:".xls"},r.fn.tableExport.csv={defaultClass:"csv",buttonContent:"Export to csv",separator:",",mimeType:"application/csv",fileExtension:".csv"},r.fn.tableExport.txt={defaultClass:"txt",buttonContent:"Export to txt",separator:"  ",mimeType:"text/plain",fileExtension:".txt"},r.fn.tableExport.defaultFileName="myDownload",r.fn.tableExport.rowDel="\r\n",r.fn.tableExport.entityMap={"&":"&#38;","<":"&#60;",">":"&#62;","'":"&#39;","/":"&#47"}}(window);